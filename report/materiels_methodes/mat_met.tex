\section{Présentation générale de la zone d'étude}

\section{Données satellitaires utilisées}

Notre série temporelle est composée de 3 types d’imageries satellitaires. Il s'agit d'images PlanetScope, RapidEye et Sentinel-2. 

  \subsection{Imageries PlanetScope et RapidEye}
  
Les images PlanetScope sont produites par la société privée américaine Planet Labs, Inc. \footnote{\url{https://www.planet.com/}}. Fondée en 2010 et basée à San Francisco 
en Californie, cette société est spécialisée dans l'observation de la terre par imagerie satellitaire. Planet Labs conçoit et fabrique des \emph{nanosatellites} ou \emph{CubSats} appelés \emph{Doves}
qui sont placés sur orbite en tant que charge utile secondaire sur d'autres missions de lancement de fusée. La société dispose ainsi d'une constellation de nanosatellites surnommée \emph{Flock}. 
La constellation est composée d'environ 150 nanosatellites en début 2017. Ces nanosatellites produisent des images complètes de la Terre une fois par jour, à une résolution 
spatiale variant de 3 à 5 mètres. Ces images fournissent des informations permettant de suivre les changements climatiques, de prévoir les récoltes, de gérer les catastrophes ou encore de 
mettre au point des applications urbaines. Les images recueillies par les Doves sont accessibles en ligne et certaines disponibles dans le cadre de l'Open Data. \\
En 2015, Planet Labs a acquis la constellation RapidEye auprès de la société allemande BlackBridge. Les images RapidEye qui ont une résolution spatiale de 5 mètres sont fournies par une 
constellation de 5 satellites. Leur période de revisite est de 5 jours et demi au nadir ou journalière sinon. Enfin en 2017, Google vend sa filiale Terra Bella et sa constellation de 
satellites \emph{SkySat} à Planet Labs. Les images SkySat ont une résolution submétrique (80 cm). 

    \paragraph{Spécifications des images PlanetScope}

Trois niveaux de traitements sont disponibles pour les images PlanetScope. Ce sont les niveaux 1B, 3A et 3B. Le niveau 1B correspond aux produits basiques. Les données numériques ont 
été calibrées en radiance \acrshort{toa} mais les images ne sont pas géoréférencées. Le niveau 3B qui est celui de nos images correspond à des produits orthorectifiés et projetés en
\acrshort{utm}. Comme pour le niveau 1B, les valeurs numériques ont été calibrées en radiance TOA. Le niveau 3A est similaire au 3B à la différence que les images sont tuilées pour 
couvrir un système de grilles de $25\times25$ kilomètres.\\
Les images PlanetScope sont distribuées en format \emph{GeoTiff}. Au niveau 3B, elles ont une résolution au sol de \emph{3 mètres} et une résolution radiométrique de \emph{12 bits} s'il 
s'agit de compte numérique ou \emph{16 bits} dans le cas des radiances TOA. Elles disposent de 4 bandes spectrales (\Cref{planetscope}). 

\begin{table}[htbp]
\begin{center}
\caption{Caractéristiques spectrales des images PlanetScope}
\label{planetscope}
 \begin{tabular}{ccc}
  \hline
  Bande spectrale & Domaine spectral & Longueurs d'onde (\textmu m)\\
  \hline
  1 & Bleu & 0,455 --- 0,515 \\
  2 & Vert & 0,500 --- 0,590 \\
  3 & Rouge & 0,590 --- 0,670 \\
  4 & Proche Infrarouge & 0,780 --- 0,860 \\ 
  \hline
 \end{tabular}
\end{center}
\end{table}

La conversion des données PlanetScope en réflectance TOA s'effectue par la formule suivante :
\begin{align}
   Reflectance (i) = DN(i) \times reflectanceFactor(i)
\end{align}

où :\\
\emph{i} = Numéro de la bande spectrale de l'image,\\
\emph{DN} = Valeurs numériques (brutes) de l'image,\\
et \emph{reflectanceFactor(i)} = Facteur de conversion en réflectance pour une bande spectrale donnée, renseigné dans les metadonnées de l'image.

  \paragraph{Spécifications des images RapidEye}

Les images RapidEye sont pour leur part, disponibles en 2 niveaux de traitements : 1B et 3A. Ces niveaux de traitements sont identiques à ceux des produits PlanetScope. Les images
RapidEye utilisées sont traitées au niveau 3A. Elles sont distribuées également en format \emph{GeoTiff}. Leur résolution au sol est de \emph{5 mètres} et leur résolution 
radiométrique de \emph{16 bits}. Elles disposent de 5 bandes spectrales (\Cref{rapideye}).

\begin{table}[htbp]
\begin{center}
\caption{Caractéristiques spectrales des images RapidEye}
\label{rapideye}
 \begin{tabular}{ccc}
  \hline
  Bande spectrale & Domaine spectral & Longueurs d'onde (\textmu m)\\
  \hline
  1 & Bleu & 0,440 --- 0,510 \\
  2 & Vert & 0,520 --- 0,590 \\
  3 & Rouge & 0,630 --- 0,685 \\
  4 & Red Edge & 0,690 --- 0,730 \\ 
  5 & Proche Infrarouge & 0,760 --- 0,850 \\
  \hline
 \end{tabular}
\end{center}
\end{table}

La conversion des données RapidEye en réflectance TOA s'effectue en 2 étapes à savoir la conversion en radiance puis la conversion en réflectance :

\begin{align} Radiance (i) = &  DN(i) \times radiometricScaleFactor(i) \\
Reflectance(i) = &  Radiance(i) \times \frac{\pi \times SunDist^2}{EAI(i) \times \cos(SolarZenith)} 
\end{align}

où :\\
\emph{i} = Numéro de la bande spectrale de l'image \\
\emph{DN} = Valeurs numériques (brutes) de l'image \\
\emph{radiometricScaleFactor(i)} = Facteur de conversion en radiance pour une bande spectrale donnée, renseigné dans les métadonnées de l'image \\
\emph{SunDist} = Distance Terre-Soleil en unités astronomiques \\
\emph{EAI(i)} = Irradiance exo-atmosphérique pour une bande spectrale donnée, renseignée dans les métadonnées de l'image \\
\emph{SolarZenith} = Angle zénithal solaire en degrés (90\textdegree - Elévation solaire)

  \subsection{Imagerie Sentinel-2}

Sentinel est une famille de 6 satellites d'observation de la Terre, développée par l'\acrshort{esa} et destinée à assurer la continuité des données de la mission \acrshort{envisat} arrivée à 
terme en 2012. Sentinel représente le volet spatial du programme Copernicus (ex \acrshort{gmes}) de l'Union Européenne qui vise à doter l'Europe d'une capacité autonome et 
opérationnelle en matière d'observation de la Terre notamment pour la surveillance de l'environnement et la sécurité \citep{Drusch2012}. La mission Sentinel-2 est la composante spatiale du programme 
devant fournir une imagerie optique haute résolution permettant l’observation des sols (utilisation, végétation, zones côtières, fleuves \ldots) ainsi que la mise en place de services 
de traitement des situations d'urgence notamment les catastrophes naturelles. Cette mission est composée de 2 satellites \emph{Sentinel-2A} et \emph{Sentinel-2B} circulant en déphasage de 
180\textdegree{} sur la même orbite héliosynchrone de 10h30. Ces 2 satellites sont identiques et embarquent l'instrument \acrshort{msi} qui fournit des images dans 13 bandes spectrales 
du Visible à l'Infrarouge (\Cref{msi}) avec une résolution spatiale comprise entre 10 et 60 mètres et une résolution radiométrique de 12 bits. Les satellites Sentinel-2 ont une période de revisite au nadir de 5 jours et doivent acquérir au moins une donnée claire par mois sur la plupart des terres émergées. Cette grande richesse spectrale couplée à cette capacité d'observation temporelle 
élevée constituent le véritable apport de la mission Sentinel-2. Les données sont principalement utilisées pour l'agriculture, la sylviculture, l'occupation des sols, la biodiversité, 
la caractérisation des habitats ou encore l'observation et la prévention des catastrophes naturelles notamment les inondations. 

\begin{table}[htbp]
\begin{center}
\caption{Caractéristiques spectrales de l'instrument MSI des Sentinel-2}
\label{msi}
 \begin{tabular}{cccc}
  \hline
  Bande spectrale & Domaine spectral & Longueurs d'onde (\textmu m) & R. spatiale (m)\\
  \hline
  \phantom{1}1 & Aérosols & 0,433 --- 0,453 & 60 \\
  \phantom{1}2 & Bleu & 0,4575 --- 0,5225 & 10 \\
  \phantom{1}3 & Vert & 0,5425 --- 0,5775 & 10 \\
  \phantom{1}4 & Rouge & 0,65 --- 0,68 & 10 \\ 
  \phantom{1}5 & Red Edge & 0,6975 --- 0,7125 & 20 \\
  \phantom{1}6 & Red Edge & 0,7325 --- 0,7475 & 20 \\
  \phantom{1}7 & Red Edge & 0,773 --- 0,793 & 20 \\
  \phantom{1}8 & Proche Infrarouge & 0,83625 --- 0,84775 & 10\\
  8A & Red Edge & 0,855 --- 0,875 & 20 \\
  \phantom{1}9 & Vapeur d'eau & 0,935 --- 0,955 & 60 \\
  10 & Cirrus & 1,365 --- 1,395 & 60 \\
  11 & Infrarouge moyen & 1,565 --- 1,655 & 20 \\
  12 & Infrarouge moyen & 2,181 --- 2,199 & 20 \\
  \hline
 \end{tabular}
\end{center}
\end{table}

Les images Sentinel-2 utilisées dans ce travail sont produites par \acrshort{theia}/\acrshort{muscate} \footnote{\url{http://www.theia-land.fr/}}. Il s'agit de données Copernicus 
Sentinel-2 de niveau 1C (données ortho-rectifiées en réflectance TOA) qui sont traités au niveau 2A (données ortho-rectifiées en réflectance de surface après correction atmosphérique
notamment par \acrshort{maccs}/\acrshort{maja} \footnote{\url{http://www.cesbio.ups-tlse.fr/multitemp/?p=6050}}). Au niveau 2A, des masques de nuages et d'ombres ainsi que 
des surfaces d’eau et de neige sont fournis. Les données de réflectance fournies sont de 2 types :
\begin{itemize}
 \item le SRE pour Surface REflectance qui incluent les corrections atmosphériques et effets d'environnement
 \item le FRE pour Flat REflectance qui incluent en plus des corrections des données SRE, les corrections liées aux effets de pente.
\end{itemize}
Notons qu'à terme, seules les données FRE seront fournis par Theia, afin de diminuer les volumes à distribuer. 

\vspace{5mm}

Nos images Sentinel-2 sont des données SRE. Elles sont codées en entiers sur du 16 bits signé. L'obtention des vraies valeurs de réflectance est donnée par :
\begin{align}
  Reflectance (i) =  \frac{ReflectanceCodee(i)}{10\,000}
\end{align}

\vspace{5mm}
 
Nous avons mis en place une chaîne de prétraitements, écrite avec le langage de programmation \texttt{Python}, pour effectuer la calibration de nos images en données de 
réflectance (TOA pour les images PlanetScope et RapidEye et réflectance de surface pour les images Sentinel-2) et leur découpage selon l'emprise de notre zone d'étude. 
Les bibliothèques \texttt{gdal} et \texttt{rasterio} ont été utilisées à cet effet. Notons que pour les images PlanetScope et certaines images RapidEye, nous avons d'abord dû 
effectuer un mosaiquage de toutes les images correspondant à la même date d'acqusition avant de les découper. Pour leur part, les bandes Red Edge des images Sentinel-2 (20 mètres 
de résolution) ont été rééchantillonnées à 10 mètres et empilées avec les bandes originelles de 10 mètres. Les bandes de 60 mètres qui sont plus relatives aux applications 
météorologiques n'ont pas été considérées dans le cadre de ce stage.

  \subsection{Chronologie des images acquises}
  
Les 27 images utilisées ont été acquises entre Juin et Novembre 2017, période couvrant la saison agricole 2017. Cependant, nous ne disposons que d'une image (PlanetScope) en Septembre. La 
Chronologie des acquisitions (\Cref{Chronologie}) est la suivante :

\begin{figure}[htb]
  \begin{center}
    \begin{tikzpicture}
     \begin{axis}[hide y axis,axis lines=middle,
      date coordinates in=x,
      xticklabel={\texttt{\month}},
      xlabel=RapidEye,
      xlabel style={at={(current axis.right of origin)}, xshift=7.5ex, anchor=center},
      %x tick label style={},
      date ZERO=2017-05-01,
      xmin=2017-05-25,
      xmax=2017-12-05,
      ymin=0,ymax=0.1,
      xtick=\empty,clip=false]
      \addplot [magenta,thick,mark=*,only marks]coordinates{
        (2017-07-27,0)
        (2017-10-06,0)
        (2017-10-26,0)
        (2017-11-09,0)
        };
      \end{axis}
  \end{tikzpicture}
  
  \begin{tikzpicture}
    \begin{axis}[hide y axis,axis lines=middle,
      date coordinates in=x,
      xticklabel={\texttt{\month}},
      xlabel=Sentinel-2,
      xlabel style={at={(current axis.right of origin)}, xshift=7.5ex, anchor=center},
      %x tick label style={},
      date ZERO=2017-05-01,
      xmin=2017-05-25,
      xmax=2017-12-05,
      ymin=0,ymax=0.1,
      xtick=\empty,clip=false]
      \addplot [magenta,thick,mark=*,only marks]coordinates{
        (2017-06-07,0)
        (2017-06-17,0)
        (2017-07-27,0)
        (2017-08-06,0)
        (2017-10-05,0)
        (2017-10-15,0)
        (2017-10-25,0)
        (2017-11-04,0)
        (2017-11-14,0)};
     \end{axis}
    \end{tikzpicture}
  
  \begin{tikzpicture}
    \begin{axis}[hide y axis,axis lines=middle,
      date coordinates in=x,
      xticklabel={\texttt{\month}},
      xlabel={PlanetScope},
      xlabel style={at={(current axis.right of origin)}, xshift=7.5ex, anchor=center},
      %x label style={},
      date ZERO=2017-05-01,
      xmin=2017-05-25,
      xmax=2017-12-05,
      ymin=0,ymax=0.1,
      xtick={{2017-06-01},{2017-07-01},{2017-08-01},{2017-09-01},{2017-10-01},{2017-11-01},{2017-12-01}},clip=false]
      \addplot [magenta,thick,mark=*,only marks]coordinates{
        (2017-06-04,0)
        (2017-06-18,0)
        (2017-07-09,0)
        (2017-07-16,0)
        (2017-07-27,0)
        (2017-08-15,0)
        (2017-09-19,0)
        (2017-10-01,0)
        (2017-10-11,0)
        (2017-10-16,0)
        (2017-10-23,0)
        (2017-10-30,0)
        (2017-11-15,0)
        (2017-11-19,0)};
    \end{axis}
   \end{tikzpicture}
   
  \end{center}
  \caption{Chronologie des images acquises}
  \label{Chronologie}
\end{figure}

\section{Données de terrain}
  
\section{Extraction d'indices spectraux}

Sur base des images de réflectance, nous avons extrait différents indices de végétation. Il importe de noter que les indices dérivés d'images RapidEye (5m) ou Sentinel-2 (10m) 
ont été rééchantillonnés à la résolution des indices PlanetScope (3m), ce afin de pouvoir considérer une série temporelle par indice calculé. 
% décalage pixels

\paragraph{NDVI} \citep{Rouse1974,Tucker1979} 

\begin{align}
 NDVI = \frac{PIR - R}{PIR + R}
\end{align}

\paragraph{MSAVI2} \citep{Qi1994}

\begin{align}
 MSAVI2 = \frac{2 \times (PIR + 1) - \sqrt{((2 \times PIR + 1)^2 - 8 \times (PIR - R))}}{2}
\end{align}

\section{Lissage des séries temporelles}

Nous disposons \`a présent d'une série temporelle, pour chaque indice de végétation calculé. Cependant, avant de pouvoir les exploiter pour la suite de notre travail, un autre 
traitement s'impose : le \emph{lissage} ou \emph{smoothing}. En effet, bien que des prétraitements soient effectuées sur les images satellitaires : calibrations radiométriques et 
corrections atmosphériques entre autres, il subsiste du bruit qui affecte l'utilisation des séries temporelles d'images, impactant ainsi les futures analyses et pouvant donc fausser les interprétations
données aux résultats obtenus \citep{Chen2004}. Ce bruit résiduel peut être lié à plusieurs facteurs notamment les conditions atmosphériques variables et la présence de pixels nuageux
indétectés. Les techniques de lissage font l'hypothèse que le bruit résiduel dans les images entraine des chutes soudaines dans le profil temporel des indices de végétation 
\citep{Bojanowski2009}. Ces valeurs peuvent être ainsi identifiées puis supprimées et des séries temporelles de meilleure qualité reconstruites.
\\L'une des techniques usuelles adoptée notamment par les fournisseurs d'indices de végétation périodique comme GIMMS-MODIS, SPOT-VEGETATION ou PROBA-V est le \acrshort{mvc}. Cette technique 
consiste à créer des synthèses d'indices de végétation sur une période donnée, généralement une décade en considérant pour chaque pixel la plus grande valeur enrégistrée sur la période.
D'autres techniques de lissage de séries temporelles d'indices de végétation ont été mises au point. Nous pouvons citer des méthodes de seuillages comme l'algorithme \acrshort{bise}, 
des méthodes basées sur l'analyse de Fourier comme \acrshort{hants} \citep{Verhoef1996} et d'autres approches par fonction asymétrique notamment gaussienne \citep{Jonsson2002}. 
\citet{Chen2004} ont introduit une méthode de lissage basée sur le filtre de Savitzky-Golay \citep{Savitzky1964}. D'autres approches ont aussi été distinguées par \citet{Geng2014} et 
\citet{Liu2017} comme la technique de lissage de Whittaker ou encore la transformation en ondelettes.
\\Plusieurs études ont comparées ces différentes techniques de lissage entre elles \citep{Jonsson2002,Chen2004,Hird2009,Geng2014,Shao2016,Liu2017}. La conclusion faite par \citet{
Geng2014} qui ont comparé notamment 8 méthodes de lissage est qu'il n'y avait pas une meilleure méthode qu'une autre, chacune présentant ses avantages et ses inconvénients. De plus, la
comparaison entre ces diverses méthodes n'est pas toujours significative du fait des différentes données utilisées et de l'application à des zones différentes. Néanmoins, s'il est vrai qu'il n'y 
a pas de méthode idéale de lissage, il n'en demeure pas moins que le filtre de Savitzky-Golay est une méthode qui revient souvent dans la littérature et qui est connue pour ses 
résultats consistants. En effet, le filtre de Savitzky-Golay est apprécié pour sa capacité à conserver la forme du profil temporel des indices de végétation ainsi que le timing et 
l'amplitude des minima et maxima locaux. Nous avons retenu et comparé 2 techniques de lissage pour nos séries temporelles : HANTS et le filtre de Savitzky-Golay.

\subsection{Lissage avec HANTS}

\subsection{Lissage avec le filtre de Savitzky-Golay}

Mois de septembre couvert par une seule image

\section{Extraction des Métriques Phénologiques}

\section{Estimation des Rendements}